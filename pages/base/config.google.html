/**
* -----------------------------------------------------------------------------
* @package     smartVISU
* @author      Stefan Widmer
* @copyright   2017
* @license     GPL [http://www.gnu.de]
* -----------------------------------------------------------------------------
*/

{% extends "root.html" %}

{% block body %}

<script type="text/javascript">
	$(document).ready(function() {
		var code = decodeURIComponent((location.search.match(/[\?&]code=(.*?)(&|$)/)||['',''])[1]);
		if(code != '') {
			// call event in opener window
			var event = (window.CustomEvent) ?
				new CustomEvent('gettoken', {'detail': {'code': code}}) :
				document.createEvent('CustomEvent').initCustomEvent('gettoken', true, true, {'code': code});
			opener.document.getElementById('googleauthform').dispatchEvent(event);

			window.close();
		}
	});

</script>

{% endblock %}